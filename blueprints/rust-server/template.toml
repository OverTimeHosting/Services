[game]
type = "rust"
startup_file = "RustDedicated"
version_source = "steam"
steam_app_id = "258550"

[variables]
RUST_SERVER_NAME = "Rust Server"
RUST_SERVER_DESCRIPTION = "A Rust Dedicated Server"
RUST_SERVER_IDENTITY = "rustserver"
RUST_SERVER_PORT = "28015"
RUST_RCON_PORT = "28016"
RUST_RCON_PASSWORD = "${password:16}"
RUST_SERVER_MAXPLAYERS = "50"
RUST_SERVER_WORLDSIZE = "3500"
RUST_SERVER_SEED = "12345"
RUST_SERVER_SAVE_INTERVAL = "600"

[config]
[config.env]
RUST_SERVER_NAME = "${RUST_SERVER_NAME}"
RUST_SERVER_DESCRIPTION = "${RUST_SERVER_DESCRIPTION}"
RUST_SERVER_IDENTITY = "${RUST_SERVER_IDENTITY}"
RUST_SERVER_PORT = "${RUST_SERVER_PORT}"
RUST_RCON_PORT = "${RUST_RCON_PORT}"
RUST_RCON_PASSWORD = "${RUST_RCON_PASSWORD}"
RUST_SERVER_MAXPLAYERS = "${RUST_SERVER_MAXPLAYERS}"
RUST_SERVER_WORLDSIZE = "${RUST_SERVER_WORLDSIZE}"
RUST_SERVER_SEED = "${RUST_SERVER_SEED}"
RUST_SERVER_SAVE_INTERVAL = "${RUST_SERVER_SAVE_INTERVAL}"

[install_script]
script = '''
#!/bin/bash
# Rust Server Installation Script
# Server Files: /steamcmd/rust

STEAMCMD_DIR="/steamcmd"
INSTALL_DIR="/steamcmd/rust"
STEAM_APP_ID=258550

mkdir -p ${INSTALL_DIR}
cd ${STEAMCMD_DIR}

echo "=========================================="
echo "Rust Dedicated Server Installation"
echo "=========================================="
echo ""
echo "Downloading Rust Dedicated Server via SteamCMD..."
echo ""

./steamcmd.sh +force_install_dir ${INSTALL_DIR} \
    +login anonymous \
    +app_update ${STEAM_APP_ID} validate \
    +quit

if [ $? -eq 0 ]; then
    echo ""
    echo "=========================================="
    echo "Rust Server Installation Complete!"
    echo "=========================================="
    echo ""
    echo "Configuration Options:"
    echo "  - World Size: 1000 (tiny) to 6000 (huge), default 3500"
    echo "  - Seed: Any number for procedural world generation"
    echo "  - Save Interval: Seconds between saves (default 600 = 10 min)"
    echo "  - Max Players: Default 50"
    echo ""
    echo "RCON Tools:"
    echo "  - RustAdmin: https://www.rustadmin.com/"
    echo "  - WebRCON: Connect to RCON_PORT with password"
    echo ""
    echo "Server will generate world on first startup."
    echo ""
else
    echo "Installation failed. Please check your connection and try again."
    exit 1
fi
'''
